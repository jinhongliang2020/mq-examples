
# RabbitMQ 

## 1.消息消费确认

 为了确保消息或者任务不会丢失，RabbitMQ支持消息确认–ACK。
 ACK机制是消费者端从RabbitMQ收到消息并处理完成后，反馈给RabbitMQ，RabbitMQ收到反馈后才将此消息从队列中删除。
 那么他就不会有ACK反馈，RabbitMQ会认为这个消息没有正常消费，会将此消息重新放入队列中。
 
 
## 2.消息持久化 

 消息确认可以防止消息丢失，那么RabbitMQ 服务挂了呢？
 这时候就需要消息持久化
 
 如果你想让RabbitMQ记住她当前的状态和内容，就需要通过2件事来确保消息和任务不会丢失。 
 
 - [x] 在队列声明时，告诉RabbitMQ，这个队列需要持久化
 
   ```
   boolean durable = true;
   channel.queueDeclare("hello", durable, false, false, null);
   ```
  
     关于消息持久化的说明： 
     
     标记为持久化后的消息也不能完全保证不会丢失。虽然已经告诉RabbitMQ消息要保存到磁盘上，但是理论上，RabbitMQ已经接收到生产者的消息，
     但是还没有来得及保存到磁盘上，服务器就挂了（比如机房断电），那么重启后，RabbitMQ中的这条未及时保存的消息就会丢失。因为RabbitMQ不做实时立即的磁盘同步（fsync）。
     这种情况下，对于持久化要求不是特别高的简单任务队列来说，还是可以满足的。如果需要更强大的保证，那么你可以考虑使用生产者确认反馈机制。
     
## 3.负载均衡     